# Clockwork API v1.0.0 (Frozen Contract)

Status: frozen for the 1.x line.  
Manifest API version: `1`

## Scope

This version freezes these public contracts from `clockwork-api`:

- `GigaPlugin`
- `PluginContext`
- `HostAccess` and snapshot models
- DSL entrypoint `gigaPlugin(...)` and DSL builders
- `EventBus` and standard `Giga*Event` payloads
- `ModAdapter` / `ModAdapterRegistry` / `AdapterInvocation` / `AdapterResponse`
- `RegistryFacade`, `Scheduler`, `StorageProvider`, `PersistentStore`, `CommandRegistry`

## Contract Rules

- No breaking signature changes in `1.x`.
- Changes in `1.x` are additive only.
- Legacy members remain available and are marked as deprecated before any future removal.

## Finalized Areas

## PluginContext

`PluginContext` fields are stable in v1.0.0:

- `manifest`
- `logger`
- `scheduler`
- `registry`
- `adapters`
- `storage`
- `commands`
- `events`
- `host`

## DSL

Stable entrypoint:

- `gigaPlugin(...)`

Dependency declaration options:

- Preferred: `dependencySpecs = listOf(DependencySpec(...))`
- Legacy compatibility style: `dependencies = listOf("id", "id >=1.0 <2.0")`

Helpers:

- `dependency(id, versionRange?)`
- `dependencySpec("id [range]")`

## Events

Stable standard events:

- `GigaTickEvent`
- `GigaPlayerJoinEvent`
- `GigaPlayerLeaveEvent`
- `GigaPlayerMoveEvent`
- `GigaWorldCreatedEvent`
- `GigaEntitySpawnEvent`
- `GigaInventoryChangeEvent`

Dispatch behavior:

- Runtime supports `exact` (default) and `polymorphic` event dispatch modes.

## Adapter Contracts

Stable invocation envelope:

- `AdapterInvocation(action, payload)`
- `AdapterResponse(success, payload, message)`

Stable registry flow:

- `register(adapter)`
- `list()`
- `find(id)`
- `invoke(adapterId, invocation)`

## Command Registry

Stable command operations:

- `register(command, description, action)`
- `registerOrReplace(command, description, action)`
- `unregister(command)`

Runtime policy modes:

- `SAFE`: payload validation + quotas + concurrency guard + timeout
- `FAST`: payload validation only (quota/concurrency/timeout bypass)

## Host Permission Model in v1.0.0

Host access is permission-gated. Plugins must declare required host permissions in `clockworkplugin.yml`.

Stable permission keys:

- `host.server.read`
- `host.server.broadcast`
- `host.player.read`
- `host.world.read`
- `host.entity.read`
- `host.entity.spawn`
- `host.inventory.read`
- `host.inventory.write`

## Compatibility Note

`RuntimeVersion.API_VERSION` remains `1`, so manifests using `apiVersion: 1` stay compatible for v1.x.

For abuse scenarios and expected outcomes see `docs/security/hardening-matrix.md`.
