<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Clockwork Docs | API Reference</title>
  <meta name="description" content="Clockwork Standalone API documentation: PluginContext, DSL, events, adapters, lifecycle." />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Space+Grotesk:wght@400;500;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="./styles.css" />
</head>
<body>
  <div class="scroll-progress" aria-hidden="true"></div>
  <div class="bg-grid" aria-hidden="true"></div>
  <div class="bg-glow bg-glow-a" aria-hidden="true"></div>
  <div class="bg-glow bg-glow-b" aria-hidden="true"></div>

  <header class="site-header reveal">
    <div class="brand">
      <span class="brand-mark">GS</span>
      <div>
        <strong>Clockwork Docs</strong>
        <p>Standalone-first API</p>
      </div>
    </div>
    <div class="header-actions">
      <a class="btn btn-ghost" href="../README.md">README</a>
      <a class="btn btn-primary" href="#quickstart">Quickstart</a>
    </div>
  </header>

  <main class="layout">
    <aside class="sidebar reveal">
      <label class="search-wrap" for="api-search">
        <span>API Search</span>
        <input id="api-search" type="search" placeholder="e.g. ctx.host, adapter, event" />
      </label>
      <nav id="docs-nav">
        <a href="#overview">Overview</a>
        <a href="#quickstart">Quickstart</a>
        <a href="#versioning">Versioning</a>
        <a href="#migration">Migration</a>
        <a href="#reference">Reference</a>
        <a href="#tutorials">Tutorials</a>
        <a href="#best-practices">Best Practices</a>
        <a href="#plugin-context">PluginContext</a>
        <a href="#dsl">DSL</a>
        <a href="#models">Models</a>
        <a href="#events">Events</a>
        <a href="#dispatch-modes">Dispatch Modes</a>
        <a href="#adapters">Adapters</a>
        <a href="#payload-helpers">Payload Helpers</a>
        <a href="#lifecycle">Lifecycle</a>
        <a href="#commands">Commands</a>
        <a href="#debugging">Debugging</a>
        <a href="#security-matrix">Security</a>
      </nav>
    </aside>

    <div class="content">
      <section id="overview" class="doc-section reveal" data-api-item="overview standalone runtime kotlin api">
        <p class="eyebrow">OVERVIEW</p>
        <h1>Clockwork API Documentation</h1>
        <p class="lead">
          This page is a fast reference for the standalone runtime: how to structure plugins,
          use `PluginContext`, subscribe to events, and invoke adapters safely.
        </p>
        <div class="pill-row">
          <span class="pill">API v1.0 Frozen</span>
          <span class="pill">Kotlin DSL</span>
          <span class="pill">Host-neutral</span>
          <span class="pill">Hot Reload</span>
          <span class="pill">Adapter Security</span>
          <span class="pill">Gameplay Pre/Post Events</span>
          <span class="pill">Hybrid Dispatch</span>
        </div>
      </section>

      <section id="versioning" class="doc-section reveal" data-api-item="api version freeze 1.0 changelog migration">
        <div class="section-head">
          <p class="eyebrow">VERSIONING</p>
          <h2>API v1.0 Freeze</h2>
        </div>
        <article class="api-card">
          <p>
            The public API is stable for the 1.x line. New 1.1 features are additive; breaking changes only land in the next major.
          </p>
          <ul>
            <li><a href="../docs/api/v1.0.0.md">API Contract v1.0.0</a></li>
            <li><a href="../docs/migrations/v1.0.md">Migration Guide v1.0</a></li>
            <li><a href="../CHANGELOG.md">Changelog</a></li>
          </ul>
        </article>
      </section>

      <section id="migration" class="doc-section reveal" data-api-item="migration upgrade compatibility 1.0 1.1 changelog checklist">
        <div class="section-head">
          <p class="eyebrow">MIGRATION</p>
          <h2>Upgrade Paths</h2>
        </div>
        <article class="api-card">
          <p>
            Use these guides when moving plugins between versions.
            For `1.0 -> 1.1`, most changes are additive, but you should still validate event/command behavior and diagnostics.
          </p>
          <ul>
            <li><a href="../docs/migrations/v1.0.md">Migration Guide v1.0</a></li>
            <li><a href="../docs/migrations/checklist-1.0.md">Migration Checklist v1.0</a></li>
            <li><a href="../CHANGELOG.md">Changelog (all changes)</a></li>
            <li><a href="../docs/ops/roadmap-1.1.md">Roadmap 1.1</a></li>
          </ul>
        </article>
      </section>

      <section id="quickstart" class="doc-section reveal" data-api-item="quickstart plugin skeleton kotlin">
        <div class="section-head">
          <p class="eyebrow">QUICKSTART</p>
          <h2>Minimal Plugin</h2>
        </div>
        <article class="api-card">
          <div class="api-card-head">
            <h3>Plugin Skeleton</h3>
            <button class="copy-btn" data-copy-target="code-plugin-skeleton">Copy</button>
          </div>
          <pre><code id="code-plugin-skeleton">class MyPlugin : GigaPlugin {
    private val plugin = gigaPlugin(id = "my-plugin") {
        systems {
            system("tick") { ctx ->
                ctx.logger.info("tick")
            }
        }
    }

    override fun onEnable(ctx: PluginContext) = plugin.onEnable(ctx)
    override fun onDisable(ctx: PluginContext) = plugin.onDisable(ctx)
}</code></pre>
        </article>
        <article class="api-card">
          <h3>Build, Load, Verify</h3>
          <ol>
            <li>Build your jar and place it into `dev-runtime/giga-plugins`</li>
            <li>Start standalone</li>
            <li>Run <code>scan</code></li>
            <li>Check <code>plugins</code> and <code>run &lt;plugin&gt; &lt;command&gt;</code></li>
            <li>Use <code>status --json</code> / <code>doctor --json</code> for diagnostics</li>
          </ol>
        </article>
      </section>

      <section id="reference" class="doc-section reveal" data-api-item="reference api classes interfaces plugincontext scheduler registry storage adapters hostaccess">
        <div class="section-head">
          <p class="eyebrow">REFERENCE</p>
          <h2>Complete API Reference</h2>
        </div>
        <article class="api-card">
          <ul>
            <li><a href="../docs/api/v1.0.0.md">API Contract v1.0.0 (frozen)</a></li>
            <li><a href="../docs/api/reference-v1.md">API Reference v1 (practical reference)</a></li>
            <li><a href="../docs/migrations/v1.0.md">Migration Guide v1.0</a></li>
          </ul>
        </article>
      </section>

      <section id="tutorials" class="doc-section reveal" data-api-item="tutorial plugin start events adapters persistence reload safe coding">
        <div class="section-head">
          <p class="eyebrow">TUTORIALS</p>
          <h2>Step-by-Step Guides</h2>
        </div>
        <div class="api-grid">
          <article class="api-card">
            <h3>Start & Basics</h3>
            <ul>
              <li><a href="../docs/tutorials/plugin-start.md">Plugin Start</a></li>
              <li><a href="../docs/tutorials/hello-plugin.md">Hello Plugin</a></li>
              <li><a href="../docs/tutorials/machine-basics.md">Machine Basics</a></li>
            </ul>
          </article>
          <article class="api-card">
            <h3>Advanced</h3>
            <ul>
              <li><a href="../docs/tutorials/events.md">Events</a></li>
              <li><a href="../docs/tutorials/cancelable-gameplay-events.md">Cancelable Gameplay Events</a></li>
              <li><a href="../docs/tutorials/adapters.md">Adapters</a></li>
              <li><a href="../docs/tutorials/payload-helper-patterns.md">Payload Helper Patterns</a></li>
              <li><a href="../docs/tutorials/persistence.md">Persistence</a></li>
              <li><a href="../docs/tutorials/reload-safe-coding.md">Reload-safe Coding</a></li>
              <li><a href="../docs/tutorials/reload-workflow.md">Reload Workflow</a></li>
            </ul>
          </article>
        </div>
      </section>

      <section id="best-practices" class="doc-section reveal" data-api-item="best practices performance security reload deterministic diagnostics">
        <div class="section-head">
          <p class="eyebrow">BEST PRACTICES</p>
          <h2>What Matters in Production</h2>
        </div>
        <article class="api-card">
          <ul>
            <li>Keep tick/event handlers small and deterministic</li>
            <li>Use stable scheduler task IDs and clean up in <code>onDisable</code></li>
            <li>Document persistence versioning and migration paths</li>
            <li>Use adapters in <code>SAFE</code> mode by default; use <code>FAST</code> only in trusted environments</li>
            <li>For support, always include JSON diagnostics: <code>status --json</code>, <code>doctor --json</code>, <code>profile &lt;id&gt; --json</code></li>
          </ul>
        </article>
      </section>

      <section id="plugin-context" class="doc-section reveal" data-api-item="plugincontext ctx host logger scheduler registry storage commands events adapters">
        <div class="section-head">
          <p class="eyebrow">CORE API</p>
          <h2>PluginContext</h2>
        </div>
        <div class="api-grid">
          <article class="api-card">
            <h3>Key Fields</h3>
            <ul>
              <li><code>ctx.logger</code> Logging</li>
              <li><code>ctx.scheduler</code> Tasks/intervals</li>
              <li><code>ctx.registry</code> Items/blocks/systems</li>
              <li><code>ctx.storage</code> Persistent JSON data</li>
              <li><code>ctx.commands</code> Plugin commands</li>
              <li><code>ctx.events</code> EventBus</li>
              <li><code>ctx.adapters</code> ModAdapterRegistry</li>
              <li><code>ctx.host</code> Host-neutral access</li>
            </ul>
          </article>

          <article class="api-card">
            <div class="api-card-head">
              <h3>Host Access Example</h3>
              <button class="copy-btn" data-copy-target="code-host-access">Copy</button>
            </div>
            <pre><code id="code-host-access">val info = ctx.host.serverInfo()
if (info != null) {
    ctx.logger.info("${info.name} players=${info.onlinePlayers}/${info.maxPlayers}")
}

val alex = ctx.host.findPlayer("Alex")
if (alex != null) {
    ctx.logger.info("Alex in world ${alex.location.world}")
}</code></pre>
          </article>
        </div>
      </section>

      <section id="dsl" class="doc-section reveal" data-api-item="dsl items blocks recipes machines systems commands">
        <div class="section-head">
          <p class="eyebrow">DSL</p>
          <h2>Registry DSL</h2>
        </div>
        <article class="api-card">
          <div class="api-card-head">
            <h3>Items, Systems, Commands</h3>
            <button class="copy-btn" data-copy-target="code-dsl">Copy</button>
          </div>
          <pre><code id="code-dsl">private val plugin = gigaPlugin(id = "factory") {
    items {
        item("gear", "Gear")
    }

    systems {
        system("machine-tick") { ctx ->
            // tick logic
        }
    }

    commands {
        command("ping", "Simple health check") { _, sender, _ ->
            "pong from $sender"
        }
    }
}</code></pre>
        </article>
      </section>

      <section id="models" class="doc-section reveal" data-api-item="models textures modelbounds modellod material collision animations">
        <div class="section-head">
          <p class="eyebrow">ASSETS</p>
          <h2>Models, LOD & Materials</h2>
        </div>
        <article class="api-card">
          <div class="api-card-head">
            <h3>Extended Model Definition</h3>
            <button class="copy-btn" data-copy-target="code-models">Copy</button>
          </div>
          <pre><code id="code-models">models {
    model(
        id = "crusher_model",
        geometryPath = "assets/factory/models/block/crusher.json",
        textures = mapOf("side" to "crusher_side"),
        material = "cutout",
        doubleSided = false,
        scale = 1.0,
        collision = true,
        bounds = ModelBounds(0.0, 0.0, 0.0, 1.0, 1.0, 1.0),
        lods = listOf(
            ModelLod(distance = 24.0, geometryPath = "assets/factory/models/block/crusher_lod1.json")
        ),
        animations = mapOf("idle" to "assets/factory/animations/crusher_idle.json")
    )
}</code></pre>
        </article>
      </section>

      <section id="events" class="doc-section reveal" data-api-item="events subscribe publish giga tick player join leave move">
        <div class="section-head">
          <p class="eyebrow">EVENTS</p>
          <h2>EventBus & Standard Events</h2>
        </div>
        <div class="api-grid">
          <article class="api-card">
            <h3>Built-in Events</h3>
            <ul>
              <li><code>GigaTickEvent</code></li>
              <li><code>GigaPlayerJoinEvent</code></li>
              <li><code>GigaPlayerLeaveEvent</code></li>
              <li><code>GigaPlayerMoveEvent</code></li>
              <li><code>GigaWorldCreatedEvent</code></li>
              <li><code>GigaEntitySpawnEvent</code></li>
              <li><code>GigaInventoryChangeEvent</code></li>
              <li><code>GigaPlayerMovePre/PostEvent</code></li>
              <li><code>GigaEntitySpawnPre/PostEvent</code></li>
              <li><code>GigaBlockBreakPre/PostEvent</code></li>
            </ul>
          </article>

          <article class="api-card">
            <div class="api-card-head">
              <h3>Subscribe Example</h3>
              <button class="copy-btn" data-copy-target="code-events">Copy</button>
            </div>
            <pre><code id="code-events">ctx.events.subscribe(GigaPlayerJoinEvent::class.java) { event ->
    ctx.logger.info("Player joined: ${event.player.name}")
}</code></pre>
          </article>
        </div>
      </section>

      <section id="dispatch-modes" class="doc-section reveal" data-api-item="event dispatch exact polymorphic hybrid order">
        <div class="section-head">
          <p class="eyebrow">EVENT SYSTEM</p>
          <h2>Dispatch Modes</h2>
        </div>
        <div class="api-grid">
          <article class="api-card">
            <h3>Modes</h3>
            <ul>
              <li><code>exact</code>: only exact event-class listeners</li>
              <li><code>polymorphic</code>: superclasses/interfaces also receive events</li>
              <li><code>hybrid</code>: exact listeners first, then polymorphic listeners</li>
            </ul>
          </article>
          <article class="api-card">
            <div class="api-card-head">
              <h3>Standalone Config</h3>
              <button class="copy-btn" data-copy-target="code-dispatch">Copy</button>
            </div>
            <pre><code id="code-dispatch"># standalone.example.properties
eventDispatchMode=hybrid</code></pre>
          </article>
        </div>
      </section>

      <section id="adapters" class="doc-section reveal" data-api-item="adapters bridge.host.server bridge.host.player invocation security rate limit timeout">
        <div class="section-head">
          <p class="eyebrow">ADAPTER API</p>
          <h2>Adapter Registry & Security</h2>
        </div>
        <div class="api-grid">
          <article class="api-card">
            <h3>Built-in IDs (host-neutral)</h3>
            <ul>
              <li><code>bridge.host.server</code> : <code>server.info</code>, <code>server.broadcast</code>, <code>world.list</code>, <code>entity.list</code></li>
              <li><code>bridge.host.player</code> : <code>player.lookup</code></li>
            </ul>
            <p><strong>Policy:</strong> <code>SAFE</code> validates payload + quotas + timeout. <code>FAST</code> is low-latency and bypasses quotas/timeout.</p>
          </article>

          <article class="api-card">
            <div class="api-card-head">
              <h3>Invoke Example</h3>
              <button class="copy-btn" data-copy-target="code-adapter">Copy</button>
            </div>
            <pre><code id="code-adapter">val response = ctx.adapters.invoke(
    adapterId = "bridge.host.server",
    invocation = AdapterInvocation(
        action = "server.info",
        payload = emptyMap()
    )
)

if (!response.success) {
    ctx.logger.info("adapter failed: ${response.message}")
}</code></pre>
          </article>
        </div>
      </section>

      <section id="payload-helpers" class="doc-section reveal" data-api-item="adapter payload helpers payloadcsv payloadenum payloadbyprefix payloadrequired">
        <div class="section-head">
          <p class="eyebrow">ADAPTER DX</p>
          <h2>Payload Helpers</h2>
        </div>
        <article class="api-card">
          <div class="api-card-head">
            <h3>Typed Payload Parsing</h3>
            <button class="copy-btn" data-copy-target="code-payload">Copy</button>
          </div>
          <pre><code id="code-payload">val player = invocation.payloadRequired("player")
val amount = invocation.payloadIntRequired("amount")
val flags = invocation.payloadCsv("flags")
val mode = invocation.payloadEnum<MyMode>("mode")
val worldCfg = invocation.payloadByPrefix("world.")

if (mode == null) {
    return AdapterResponse(success = false, message = "invalid mode")
}</code></pre>
        </article>
      </section>

      <section id="lifecycle" class="doc-section reveal" data-api-item="lifecycle onenable ondisable reload report diagnostics profile">
        <div class="section-head">
          <p class="eyebrow">LIFECYCLE</p>
          <h2>Reload, Diagnostics, Profile</h2>
        </div>
        <article class="api-card">
          <ul>
            <li><code>reload &lt;plugin|all&gt;</code> with transactional behavior</li>
            <li><code>doctor [--json]</code> for dependency/API checks</li>
            <li><code>profile &lt;plugin&gt; [--json]</code> for runtime metrics</li>
            <li><code>status</code> including tick phases and net metrics</li>
          </ul>
        </article>
      </section>

      <section id="commands" class="doc-section reveal" data-api-item="commands standalone console scan reload run adapters profile doctor">
        <div class="section-head">
          <p class="eyebrow">COMMAND REFERENCE</p>
          <h2>Standalone Console</h2>
        </div>
        <article class="api-card">
          <pre><code>help
status [--json]
scan
reload &lt;id|all&gt;
doctor [--json]
profile &lt;id&gt; [--json]
run &lt;plugin&gt; &lt;command...&gt;
adapters &lt;plugin&gt; [--json]
adapter invoke &lt;plugin&gt; &lt;adapterId&gt; &lt;action&gt; [k=v ...] [--json]</code></pre>
        </article>
      </section>

      <section id="debugging" class="doc-section reveal" data-api-item="debug troubleshooting doctor profile status playbook">
        <div class="section-head">
          <p class="eyebrow">DEBUGGING</p>
          <h2>Plugin Debug Playbook</h2>
        </div>
        <article class="api-card">
          <p>If a plugin does not load or behaves inconsistently, follow this checklist:</p>
          <ul>
            <li><a href="../docs/troubleshooting/plugin-debug-playbook.md">docs/troubleshooting/plugin-debug-playbook.md</a></li>
            <li><a href="../docs/index.md">docs/index.md</a></li>
          </ul>
        </article>
      </section>

      <section id="security-matrix" class="doc-section reveal" data-api-item="security matrix abuse tests dos hardening">
        <div class="section-head">
          <p class="eyebrow">SECURITY</p>
          <h2>Security Matrix & Abuse Tests</h2>
        </div>
        <article class="api-card">
          <p>You can find the reproducible security test matrix, including abuse scenarios, here:</p>
          <ul>
            <li><a href="../docs/security/hardening-matrix.md">docs/security/hardening-matrix.md</a></li>
          </ul>
        </article>
      </section>
    </div>
  </main>

  <footer class="site-footer reveal">
    <p>Clockwork Docs • Standalone API • Kotlin-first</p>
  </footer>

  <script src="./app.js"></script>
</body>
</html>
